<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="mobile_manipulator">

    <xacro:include filename="$(find my_robot_bringup)/urdf/my_robot.gazebo.xacro" />
    
    <material name="blue"><color rgba="0 0 0.8 1"/></material>
    <material name="white"><color rgba="1 1 1 1"/></material>
    <material name="black"><color rgba="0 0 0 1"/></material>
    <material name="red"><color rgba="0.8 0 0 1"/></material>

    <xacro:macro name="default_inertial" params="mass">
        <inertial>
            <mass value="${mass}" />
            <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01" />
        </inertial>
    </xacro:macro>

    <link name="base_link">
        <visual>
            <geometry><box size="0.25 0.2 0.1"/></geometry>
            <material name="blue"/>
        </visual>
        <collision>
            <geometry><box size="0.25 0.2 0.1"/></geometry>
        </collision>
        <inertial>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <mass value="20.0"/>
            <inertia ixx="0.5" ixy="0.0" ixz="0.0" iyy="0.5" iyz="0.0" izz="0.5"/>
        </inertial>
    </link>

    <link name="base_footprint"/>
    <joint name="base_joint" type="fixed">
        <parent link="base_footprint"/>
        <child link="base_link"/>
        <origin xyz="0 0 0.05" rpy="0 0 0"/>
    </joint>

    <link name="left_wheel">
        <visual><geometry><cylinder radius="0.05" length="0.04"/></geometry><material name="white"/></visual>
        <collision><geometry><cylinder radius="0.05" length="0.04"/></geometry></collision>
        <xacro:default_inertial mass="2.0"/>
    </link>
    <joint name="left_wheel_joint" type="continuous">
        <parent link="base_link"/><child link="left_wheel"/>
        <origin xyz="0 0.11 -0.025" rpy="-1.57 0 0"/><axis xyz="0 0 1"/>
    </joint>

    <link name="right_wheel">
        <visual><geometry><cylinder radius="0.05" length="0.04"/></geometry><material name="white"/></visual>
        <collision><geometry><cylinder radius="0.05" length="0.04"/></geometry></collision>
        <xacro:default_inertial mass="2.0"/>
    </link>
    <joint name="right_wheel_joint" type="continuous">
        <parent link="base_link"/><child link="right_wheel"/>
        <origin xyz="0 -0.11 -0.025" rpy="-1.57 0 0"/><axis xyz="0 0 1"/>
    </joint>

    <link name="caster_wheel">
        <visual><geometry><sphere radius="0.025"/></geometry><material name="white"/></visual>
        <collision><geometry><sphere radius="0.025"/></geometry></collision>
        <xacro:default_inertial mass="0.5"/>
    </link>
    <joint name="caster_joint" type="fixed">
        <parent link="base_link"/>
        <child link="caster_wheel"/> <origin xyz="0.1 0 -0.05"/>
    </joint>

    <link name="back_caster_wheel">
        <visual><geometry><sphere radius="0.025"/></geometry><material name="white"/></visual>
        <collision><geometry><sphere radius="0.025"/></geometry></collision>
        <xacro:default_inertial mass="0.5"/>
    </link>
    <joint name="back_caster_joint" type="fixed">
        <parent link="base_link"/><child link="back_caster_wheel"/><origin xyz="-0.1 0 -0.05"/> 
    </joint>

    <link name="arm_base">
        <visual>
            <geometry><cylinder radius="0.04" length="0.05"/></geometry>
            <material name="white"/>
        </visual>
        <collision>
            <geometry><cylinder radius="0.04" length="0.05"/></geometry>
        </collision>
        <xacro:default_inertial mass="0.5"/>
    </link>
    <joint name="arm_base_joint" type="revolute">
        <parent link="base_link"/>
        <child link="arm_base"/>
        <origin xyz="0 0 0.05" rpy="0 0 0"/> <axis xyz="0 0 1"/> 
        <limit lower="-3.14" upper="3.14" effort="10.0" velocity="1.0"/>
        <dynamics damping="50.0" friction="10.0"/>
    </joint>

    <link name="arm_link1">
        <visual>
            <geometry><box size="0.04 0.04 0.2"/></geometry>
            <origin xyz="0 0 0.1" rpy="0 0 0"/> <material name="blue"/>
        </visual>
        <collision>
            <geometry><box size="0.04 0.04 0.2"/></geometry>
            <origin xyz="0 0 0.1" rpy="0 0 0"/>
        </collision>
        <xacro:default_inertial mass="0.3"/>
    </link>
    <joint name="shoulder_joint" type="revolute">
        <parent link="arm_base"/>
        <child link="arm_link1"/>
        <origin xyz="0 0 0.025" rpy="0 0 0"/>
        <axis xyz="0 1 0"/> 
        <limit lower="-1.57" upper="1.57" effort="10.0" velocity="1.0"/>
    </joint>

    <link name="arm_link2">
        <visual>
            <geometry><box size="0.03 0.03 0.2"/></geometry>
            <origin xyz="0 0 0.1" rpy="0 0 0"/>
            <material name="white"/>
        </visual>
        <collision>
            <geometry><box size="0.03 0.03 0.2"/></geometry>
            <origin xyz="0 0 0.1" rpy="0 0 0"/>
        </collision>
        <xacro:default_inertial mass="0.2"/>
    </link>
    <joint name="elbow_joint" type="revolute">
        <parent link="arm_link1"/>
        <child link="arm_link2"/>
        <origin xyz="0 0 0.2" rpy="0 0 0"/> <axis xyz="0 1 0"/> 
        <limit lower="-1.57" upper="1.57" effort="10.0" velocity="1.0"/>
    </joint>

    <link name="gripper">
        <visual>
            <geometry><sphere radius="0.025"/></geometry>
            <material name="blue"/>
        </visual>
        <collision>
            <geometry><sphere radius="0.025"/></geometry>
        </collision>
        <xacro:default_inertial mass="0.1"/>
    </link>
    <joint name="gripper_joint" type="fixed"> 
        <parent link="arm_link2"/>
        <child link="gripper"/>
        <origin xyz="0 0 0.2" rpy="0 0 0"/> </joint>

    <link name="lidar_link">
        <visual>
            <geometry><cylinder radius="0.02" length="0.02"/></geometry>
            <material name="black"/>
        </visual>
        <collision>
            <geometry><cylinder radius="0.02" length="0.02"/></geometry>
        </collision>
        <xacro:default_inertial mass="0.1"/>
    </link>
    <joint name="lidar_joint" type="fixed">
        <parent link="base_link"/>
        <child link="lidar_link"/>
        <origin xyz="0.1 0 0.06" rpy="0 0 0"/> 
    </joint>

    <link name="camera_link">
        <visual>
            <geometry><box size="0.025 0.025 0.025"/></geometry>
            <material name="red"/>
        </visual>
        <collision>
            <geometry><box size="0.025 0.025 0.025"/></geometry>
        </collision>
        <xacro:default_inertial mass="0.05"/>
    </link>
    <joint name="camera_joint" type="fixed">
        <parent link="lidar_link"/>
        <child link="camera_link"/>
        <origin xyz="0 0 0.025" rpy="0 0 0"/> </joint>

    <ros2_control name="GazeboSystem" type="system">
        <hardware>
            <plugin>gazebo_ros2_control/GazeboSystem</plugin>
        </hardware>
        <joint name="arm_base_joint">
            <command_interface name="position"/>
            <state_interface name="position"/>
            <state_interface name="velocity"/>
        </joint>
        <joint name="shoulder_joint">
            <command_interface name="position"/>
            <state_interface name="position"/>
            <state_interface name="velocity"/>
        </joint>
        <joint name="elbow_joint">
            <command_interface name="position"/>
            <state_interface name="position"/>
            <state_interface name="velocity"/>
        </joint>
    </ros2_control>

</robot>